<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="utf-8">
    <title>Thanh toán - Fruitables</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    
    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&family=Raleway:wght@600;800&display=swap" rel="stylesheet"> 

    <!-- Icon Font Stylesheet -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css"/>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">

    <!-- Customized Bootstrap Stylesheet -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
</head>

<body>
    <!-- Spinner Start -->
    <div id="spinner" class="show w-100 vh-100 bg-white position-fixed translate-middle top-50 start-50 d-flex align-items-center justify-content-center">
        <div class="spinner-grow text-primary" role="status"></div>
    </div>
    <!-- Spinner End -->

    <!-- Navbar Start -->
    <!-- (Giữ nguyên phần navbar như các trang khác) -->
    <!-- Navbar End -->

    <!-- Checkout Start -->
    <div class="container-fluid py-5">
        <div class="container py-5">
            <div class="mb-4">
                <a href="cart.html" class="btn btn-outline-primary rounded-pill px-4 py-2">
                    <i class="fa fa-arrow-left me-2"></i>Quay lại giỏ hàng
                </a>
            </div>
            <div class="row g-5">
                <div class="col-lg-6">
                    <h4 class="mb-4">Thông tin giao hàng</h4>
                    <div class="row g-3">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label>Họ và tên *</label>
                                <input type="text" class="form-control" required>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label>Email *</label>
                                <input type="email" class="form-control" required>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label>Số điện thoại *</label>
                                <input type="tel" class="form-control" required>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label>Tỉnh/Thành phố *</label>
                                <select id="city-select" class="form-control" required>
                                    <option value="">Chọn tỉnh/thành phố</option>
                                    <option value="HCM">TP. Hồ Chí Minh</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label>Quận/Huyện <span class="text-muted small">(bắt buộc khi chọn TP.HCM)</span></label>
                                <select id="district-select" class="form-control" disabled>
                                    <option value="">Chọn quận/huyện</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label>Phường/Xã <span class="text-muted small">(bắt buộc khi đã chọn Quận/Huyện)</span></label>
                                <select id="ward-select" class="form-control" disabled>
                                    <option value="">Chọn phường/xã</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="form-group">
                                <label>Địa chỉ chi tiết *</label>
                                <textarea class="form-control" rows="3" required></textarea>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="form-group">
                                <label>Ghi chú</label>
                                <textarea class="form-control" rows="3" placeholder="Ghi chú về đơn hàng"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6">
                    <h4 class="mb-4">Thông tin đơn hàng</h4>
                    <div class="table-responsive">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Sản phẩm</th>
                                    <th>Số lượng</th>
                                    <th>Giá</th>
                                    <th>Tổng</th>
                                </tr>
                            </thead>
                            <tbody id="checkout-items">
                                <!-- Items will be added here by JavaScript -->
                            </tbody>
                            <tfoot>
                                <tr>
                                    <td colspan="3"><strong>Tạm tính:</strong></td>
                                    <td id="subtotal">0đ</td>
                                </tr>
                                <tr>
                                    <td colspan="3"><strong>Phí vận chuyển:</strong></td>
                                    <td id="shipping">30.000đ</td>
                                </tr>
                                <tr>
                                    <td colspan="3"><strong>Tổng cộng:</strong></td>
                                    <td id="total">0đ</td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>

                    <h4 class="mb-4">Phương thức thanh toán</h4>
                    <div class="payment-methods">
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="radio" name="payment" id="cod" checked>
                            <label class="form-check-label" for="cod">
                                Thanh toán khi nhận hàng (COD)
                            </label>
                        </div>
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="radio" name="payment" id="bank">
                            <label class="form-check-label" for="bank">
                                Chuyển khoản ngân hàng
                            </label>
                        </div>
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="radio" name="payment" id="momo">
                            <label class="form-check-label" for="momo">
                                Ví MoMo
                            </label>
                        </div>
                    </div>

                    <!-- Bank transfer details with VietQR -->
                    <div id="bank-transfer-box" class="card border-0 shadow-sm p-3 d-none">
                        <h5 class="mb-2">Quét mã để chuyển khoản</h5>
                        <p class="mb-1 small text-muted">Ngân hàng và nội dung chuyển khoản</p>
                        <div class="row g-3 align-items-center">
                            <div class="col-sm-6">
                                <ul class="list-unstyled mb-2 small">
                                    <li><strong>Ngân hàng:</strong> <span id="qr-bank-name">Vietcombank (VCB)</span></li>
                                    <li><strong>Số tài khoản:</strong> <span id="qr-account">0123456789</span></li>
                                    <li><strong>Chủ tài khoản:</strong> <span id="qr-account-name">NGUYEN VAN A</span></li>
                                    <li><strong>Số tiền:</strong> <span id="qr-amount">0đ</span></li>
                                    <li><strong>Nội dung:</strong> <span id="qr-memo">ORDER-xxxx</span></li>
                                </ul>
                                <div class="d-flex gap-2">
                                    <button type="button" class="btn btn-outline-secondary btn-sm" id="btn-copy-memo">Sao chép nội dung</button>
                                    <a id="btn-download-qr" class="btn btn-outline-primary btn-sm" download="vietqr.png">Tải QR</a>
                                </div>
                            </div>
                            <div class="col-sm-6 text-center">
                                <img id="vietqr-img" alt="VietQR" class="img-fluid rounded border" style="max-width: 220px;" onerror="this.style.display='none';document.getElementById('qr-fallback').style.display='inline-block'">
                                <div id="qr-fallback" class="d-none mt-2"></div>
                                <div class="small text-muted mt-2">Nếu ảnh QR không hiện, dùng QR dự phòng hoặc kiểm tra kết nối mạng.</div>
                            </div>
                        </div>
                    </div>

                    <button class="btn btn-primary w-100 mt-4" id="place-order">Đặt hàng</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Checkout End -->

    <!-- Footer Start -->
    <!-- (Giữ nguyên phần footer như các trang khác) -->
    <!-- Footer End -->

    <!-- JavaScript Libraries -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Template / Common Scripts -->
    <script src="../js/main.js"></script>

    <!-- Custom Scripts -->
    <script src="../js/cart.js"></script>
    <!-- Lightweight QR code generator for fallback (CDN) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="../js/checkout.js"></script>
</body>
</html>